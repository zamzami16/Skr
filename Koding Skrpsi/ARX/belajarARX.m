% u=[1.4601,0.8849,1.1854,1.0887,1.413,1.3096,1.0651,0.7148,...
%     1.3571,1.0557,1.1923,1.3335,1.4374,1.2905,0.841,1.0245,...
%     1.4483,1.4335,1.0282,1.4149,0.7463,0.9822,1.3505,0.7078,...
%     0.8111,0.8622,0.8589,1.183,0.9177,0.859,0.7122,1.2974,...
%     1.056,1.4454,1.0727,1.0349,1.3769,1.1201,0.8621,1.2377,...
%     1.3704,0.7157,1.245,1.0035,1.3654,1.1022,1.2675,1.0431]';
% y=[0,0,8.7606,13.1939,17.41,17.6361,18.7627,18.5296,17.0414,...
%     13.4154,14.4539,14.59,16.1104,17.6853,19.4981,19.5935,...
%     16.4106,14.3359,15.7463,18.1179,17.784,18.8104,15.3056,...
%     13.7004,14.8178,13.2354,12.2993,11.6001,11.6074,13.7662,...
%     14.195,13.763,11.8713,13.8566,14.6944,17.8659,17.6543,...
%     16.6386,17.1071,16.5373,14.643,15.0862,16.8058,14.7641,...
%     15.4976,14.679,16.6552,16.6301]';
% t1=arx([y,u],[4,4,1]);
% t1
%addpatch('Z:\UNAIR\STUDY\SKRIPSI\DATA\DATA_odi2kg_(6)2019_10_1_5999');

% u=[1.4601,0.8849,1.1854,1.0887,1.413,1.3096,1.0651,0.7148,...
%     1.3571,1.0557,1.1923,1.3335,1.4374,1.2905,0.841,1.0245,...
%     1.4483,1.4335,1.0282,1.4149,0.7463,0.9822,1.3505,0.7078,...
%     0.8111,0.8622,0.8589,1.183,0.9177,0.859,0.7122,1.2974,...
%     1.056,1.4454,1.0727,1.0349,1.3769,1.1201,0.8621,1.2377,...
%     1.3704,0.7157,1.245,1.0035,1.3654,1.1022,1.2675,1.0431]';
% y=[0,0,8.7606,13.1939,17.41,17.6361,18.7627,18.5296,17.0414,...
%     13.4154,14.4539,14.59,16.1104,17.6853,19.4981,19.5935,...
%     16.4106,14.3359,15.7463,18.1179,17.784,18.8104,15.3056,...
%     13.7004,14.8178,13.2354,12.2993,11.6001,11.6074,13.7662,...
%     14.195,13.763,11.8713,13.8566,14.6944,17.8659,17.6543,...
%     16.6386,17.1071,16.5373,14.643,15.0862,16.8058,14.7641,...
%     15.4976,14.679,16.6552,16.6301]';
% t=[0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0,1.1,1.2,1.3,1.4,...
%     1.5,1.6,1.7,1.8,1.9,2.0,2.1,2.2,2.3,2.4,2.5,2.6,2.7,2.8,2.9,3,...
%     3.1,3.2,3.3,3.4,3.5,3.6,3.7,3.8,3.9,4,4.1,4.2,4.3,4.4,4.5,4.6,4.7]';

loc='Z:\UNAIR\STUDY\SKRIPSI\DATA\DATA_odi2kg_(6.2)2019_10_1_2999';
data1 = csvread([loc '\' 'DATA_odi2kg_(6.2)2019_10_1_2999.csv'],1,1);
%% Filtering using butterworth filter of order 4
% High-pass filter
filt1 = fdesign.highpass('n,f3db',4,2*10*(1/1000)); %high-pass filter, cut off frequency at 10Hz, sampling frequency of 1kHz
H1 = design(filt1,'butter');
highpass_EMG = filter(H1, data1(:,7)); % sampling frequency of 1kHz
% Low-pass filter
filt2 = fdesign.lowpass('n,f3db',4,2*500*(1/1000)); %low-pass filter, cut off frequency at 500Hz
H2 = design(filt2,'butter');
lowpass_EMG = filter(H2,highpass_EMG);
% Notch Filter (50Hz)
filt3 = fdesign.notch(4,0.05,10); %notch filter (50Hz)
H3 = design(filt3);
cleaned_EMG = filter(H3,lowpass_EMG);
figure(1);plot(cleaned_EMG);
y=data1(:,6);
u=abs(cleaned_EMG);
U=iddata(y,u,0.1);
% T=arx(U,[8,8,1]);
% H=tf(T);
% G=H(1);

for nn=1:12, for mm=1:12
        T=arx(U,[nn,mm,3]); TAic1(nn,mm)=aic(T);
        T=arx(U,[nn,mm,2]); TAic2(nn,mm)=aic(T);
    end, end
TAic1
TAic2

% lsim(G,u,t)
% hold on, plot(t,y,'-*',t,u,'o')
% 
% figure(2)
% subplot(2,1,1);
% plot(t,u);
% title('input');
% subplot(2,1,2);
% plot(t,y);
% title('output');

